"use strict";function getEmojiButtons(t){var e=t.getElementsByClassName("reaction-summary-item"),n=Array.prototype.map.call(e,function(t){var e=t.getElementsByTagName("g-emoji")[0];if(!e)return{};var n=e.getAttribute("alias"),r=t.lastChild.textContent.trim()||0,o=e.textContent.trim();return{emoji:e,score:r,icon:o,alias:n}}).filter(function(t){return t.emoji});return n}function getCommentsJson(){var t=document.getElementsByClassName("js-comment-container");return Array.prototype.map.call(t,function(t,e){var n=t.offsetTop,r=t.querySelector(".author");if(!r)return{};var o=r.textContent,i=t.querySelector(".avatar").getAttribute("src"),a=t.querySelector(".js-timestamp").getAttribute("href"),s=t.querySelector("relative-time").getAttribute("datetime"),c=t.querySelector(".timeline-comment-label"),u="";t.querySelector(".timeline-comment-label")&&(u=c.textContent.trim());var l=getEmojiButtons(t),d=l.filter(function(t){return positives.includes(t.alias)}).reduce(function(t,e){return+e.score+t},0),m=l.reduce(function(t,e){return+e.score+t},0);return{id:e,item:t,offsetTop:n,author:o,avatar:i,anchor:a,role:u,datetime:s,buttons:l,scores:d,eyes:m}})}function sortByScoreEyes(t){return t.sort(function(t,e){return t.scores!==e.scores?-(t.scores-e.scores):-(t.eyes-e.eyes)}).map(function(t,e,n){return _extends({},t,{rank:e})})}var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},debug=function(t,e){},positives=["+1","tada","heart","smile"],getListItem=function(t,e){var n=document.createElement("li");console.log("li",n);var r=t.buttons.map(function(t){return t.icon+" "+t.score}).join(" "),o=t.role?'<span class="toc-divider"></span>\n    <div title="'+t.role+'" class="toc-role">'+t.role.slice(0,1)+"</div>":"";return n.innerHTML='\n  <a class="'+e+'" title="'+t.author+'" href="'+t.anchor+'" data-offset="'+t.offsetTop+'">\n    <img class="avatar" width="32" height="32" src="'+t.avatar+'">\n    <div class="toc-detail">\n      <div class="toc-emoji">'+r+'</div>\n      <div class="toc-author">'+t.author+"</div>\n    </div>\n    "+o+"\n  </a>",n},isExtLoaded=function(){var t=document.getElementById("github-issue-toc");return!!t},start=function(){var t=getCommentsJson().filter(function(t){return t.author});if(debug("comments",t),0!==t.length){var e=t[0],n=sortByScoreEyes(t.slice(1)),r=document.getElementById("partial-discussion-sidebar")||document.getElementsByClassName("discussion-sidebar")[0],o=document.createElement("div");o.id="github-issue-toc";var i=document.createElement("div");i.innerHTML='<a target="_blank" href="https://github.com/wooodhead/github-issue-toc">\n  <svg height="14" width="32"  class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>\n  <span>github-issue-toc</span></a>\n  ',i.id="github-issue-toc-header";var a=document.createElement("div");a.id="github-issue-toc-body";var s=getListItem(e,"toc-asker");a.appendChild(s);var c=document.createElement("ul");c.id="toc-answers",n.forEach(function(t){var e=getListItem(t);c.appendChild(e)}),a.appendChild(c),o.appendChild(i),o.appendChild(a);var u=document.getElementById("github-issue-toc");u&&r.removeChild(u),r.appendChild(o)}},validateUrl=function(){var t=window.location.pathname,e=t.split("/"),n=!!parseInt(e.pop(),10),r=e.pop(),o="issues"===r||"pull"===r;return n&&o},loop=function(){setInterval(function(){var t=validateUrl();t&&!isExtLoaded()&&start()},2e3)};window.onload=function(){console.log("onload");var t=validateUrl();t&&start(),loop()};
//# sourceMappingURL=contentscript.js.map
